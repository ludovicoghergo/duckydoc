{"remainingRequest":"/home/ludov/Desktop/duckydoc/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ludov/Desktop/duckydoc/frontend/src/views/Documents.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/ludov/Desktop/duckydoc/frontend/src/views/Documents.vue","mtime":1616778603593},{"path":"/home/ludov/Desktop/duckydoc/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ludov/Desktop/duckydoc/frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/ludov/Desktop/duckydoc/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ludov/Desktop/duckydoc/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiRG9jdW1lbnRzIiwKICBjb21wb25lbnRzOiB7fSwKICBtZXRob2RzOiB7CiAgICBjaGVja19jb29raWVfdmFsdWUobmFtZSkgewogICAgICB2YXIgbWF0Y2ggPSBkb2N1bWVudC5jb29raWUubWF0Y2goCiAgICAgICAgbmV3IFJlZ0V4cCgiKF58ICkiICsgbmFtZSArICI9KFteO10rKSIpCiAgICAgICk7CiAgICAgIGlmIChtYXRjaCkgewogICAgICAgIHJldHVybiBtYXRjaFsyXTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gLTE7CiAgICAgIH0KICAgIH0sCiAgICBjb252ZXJ0RGF0ZShkYXRlU3RyaW5nKSB7CiAgICAgIGRhdGVTdHJpbmcgPSBkYXRlU3RyaW5nLnRvU3RyaW5nKCk7CiAgICAgIHJldHVybiBkYXRlU3RyaW5nLnJlcGxhY2UoLyhcZHs0fSkoXGRcZCkoXGRcZCkvZywgIiQyLyQzLyQxIik7CiAgICB9LAogICAgZG93bmxvYWRJdChpZCwgbmFtZWZpbGUsIGNvc3QpIHsKICAgICAgdmFyIGlkVXNlciA9IHRoaXMuY2hlY2tfY29va2llX3ZhbHVlKCJpZCIpOwogICAgICB2YXIgaWRHb29nbGUgPSB0aGlzLmNoZWNrX2Nvb2tpZV92YWx1ZSgiVG9rZW4iKTsKICAgICAgdGhpcy5mb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpOwoKICAgICAgYXhpb3MKICAgICAgICAuZ2V0KCJodHRwOi8vbG9jYWxob3N0OjgwODUvYXBpL3V0ZW50aS8iICsgaWRHb29nbGUpCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5jcmVkaXRzID4gY29zdCkgewogICAgICAgICAgICB0aGlzLmZvcm1EYXRhLmFwcGVuZCgiY3JlZGl0cyIsIHJlc3BvbnNlLmRhdGEuY3JlZGl0cyAtIGNvc3QpOwogICAgICAgICAgICBheGlvcwogICAgICAgICAgICAgIC5nZXQoImh0dHA6Ly9sb2NhbGhvc3Q6ODA4NS9hcGkvZG9jdW1lbnRzLyIgKyBpZCwgewogICAgICAgICAgICAgICAgcmVzcG9uc2VUeXBlOiAiYmxvYiIsCiAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IHVybCA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKAogICAgICAgICAgICAgICAgICBuZXcgQmxvYihbcmVzcG9uc2UuZGF0YV0pCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UuaGVhZGVyc1siY29udGVudC10eXBlIl0pOwogICAgICAgICAgICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKTsKICAgICAgICAgICAgICAgIGxpbmsuaHJlZiA9IHVybDsKICAgICAgICAgICAgICAgIGxpbmsuc2V0QXR0cmlidXRlKCJkb3dubG9hZCIsIG5hbWVmaWxlKTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobGluayk7CiAgICAgICAgICAgICAgICBsaW5rLmNsaWNrKCk7CiAgICAgICAgICAgICAgICBheGlvcwogICAgICAgICAgICAgICAgICAucHV0KAogICAgICAgICAgICAgICAgICAgICJodHRwOi8vbG9jYWxob3N0OjgwODUvYXBpL3V0ZW50aS8iICsKICAgICAgICAgICAgICAgICAgICAgIGlkVXNlciArCiAgICAgICAgICAgICAgICAgICAgICAiL3VwZGF0ZWNyZWRpdCIsCiAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtRGF0YQogICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlLmRhdGEuY3JlZGl0cyk7CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKICAgIHNlYXJjaERvY3VtZW50cygpIHsKICAgICAgYXhpb3MKICAgICAgICAuZ2V0KAogICAgICAgICAgImh0dHA6Ly9sb2NhbGhvc3Q6ODA4NS9hcGkvZG9jdW1lbnRzL3NlYXJjaC8iICsKICAgICAgICAgICAgdGhpcy5zZWFyY2hVbmkgKwogICAgICAgICAgICAiLyIgKwogICAgICAgICAgICB0aGlzLnNlYXJjaENvdXJzZSArCiAgICAgICAgICAgICIvIiArCiAgICAgICAgICAgIHRoaXMuc2VhcmNoVHlwZSArCiAgICAgICAgICAgICIvIiArCiAgICAgICAgICAgIHRoaXMuc2VhcmNoWWVhcgogICAgICAgICkKICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgIHRoaXMuZG9jdW1lbnRzID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICB9KTsKICAgIH0sCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgc2VhcmNoVW5pOiBudWxsLAogICAgICBzZWFyY2hDb3Vyc2U6IG51bGwsCiAgICAgIHNlYXJjaFR5cGU6IG51bGwsCiAgICAgIHNlYXJjaFllYXI6IG51bGwsCiAgICAgIGRvY3VtZW50czogW10sCiAgICB9OwogIH0sCiAgbW91bnRlZCgpIHsKICAgIGF4aW9zLmdldCgiaHR0cDovL2xvY2FsaG9zdDo4MDg1L2FwaS9kb2N1bWVudHMvIikudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgdGhpcy5kb2N1bWVudHMgPSByZXNwb25zZS5kYXRhOwogICAgfSk7CiAgfSwKfTsK"},{"version":3,"sources":["Documents.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Documents.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <v-row>\n      <v-col cols=\"3\">\n        <v-navigation-drawer\n          permanent\n          class=\"full_heigth\"\n          style=\"height: 100%; width: 100%\"\n          dark\n        >\n          <v-list dense>\n            <v-list-item>\n              <v-list-item-content>\n                <v-list-item-title>University</v-list-item-title>\n                <v-text-field\n                  v-model=\"searchUni\"\n                  placeholder=\"insert some keywords\"\n                  solo\n                  class=\"mt-2\"\n                ></v-text-field>\n              </v-list-item-content>\n            </v-list-item>\n\n            <v-list-item>\n              <v-list-item-content>\n                <v-list-item-title>Course</v-list-item-title>\n                <v-text-field\n                  v-model=\"searchCourse\"\n                  placeholder=\"insert some keywords\"\n                  solo\n                  class=\"mt-2\"\n                ></v-text-field>\n              </v-list-item-content>\n            </v-list-item>\n\n            <v-list-item>\n              <v-list-item-content>\n                <v-list-item-title>Typology</v-list-item-title>\n                <v-text-field\n                  v-model=\"searchType\"\n                  placeholder=\"insert some keywords\"\n                  solo\n                  class=\"mt-2\"\n                ></v-text-field>\n              </v-list-item-content>\n            </v-list-item>\n            <v-list-item>\n              <v-list-item-content>\n                <v-list-item-title>Year</v-list-item-title>\n                <v-text-field\n                  v-model=\"searchYear\"\n                  placeholder=\"insert some keywords\"\n                  solo\n                  class=\"mt-2\"\n                ></v-text-field>\n              </v-list-item-content>\n            </v-list-item>\n            <v-list-item>\n              <v-btn @click=\"searchDocuments()\" class=\"center\">\n                Search your params\n              </v-btn>\n            </v-list-item>\n          </v-list>\n        </v-navigation-drawer>\n      </v-col>\n      <v-col cols=\"9\">\n        <v-card\n          v-for=\"(document, index) in documents\"\n          :key=\"index\"\n          color=\"#f4ecb4\"\n          class=\"mt-2 document\"\n        >\n          <v-card-title class=\"headline\"> {{ document.title }}</v-card-title>\n\n          <v-card-text>{{ document.user.username }}</v-card-text>\n\n          <v-card-actions class=\"card-actions\">\n            <v-btn\n              @click=\"\n                downloadIt(document.id, document.nameFile, document.price)\n              \"\n            >\n              Download\n            </v-btn>\n          </v-card-actions>\n          <v-card-actions class=\"card-actions2\">\n            <v-btn text disabled>\n              {{ convertDate(document.creationData) }}\n            </v-btn>\n          </v-card-actions>\n        </v-card>\n      </v-col>\n    </v-row>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nexport default {\n  name: \"Documents\",\n  components: {},\n  methods: {\n    check_cookie_value(name) {\n      var match = document.cookie.match(\n        new RegExp(\"(^| )\" + name + \"=([^;]+)\")\n      );\n      if (match) {\n        return match[2];\n      } else {\n        return -1;\n      }\n    },\n    convertDate(dateString) {\n      dateString = dateString.toString();\n      return dateString.replace(/(\\d{4})(\\d\\d)(\\d\\d)/g, \"$2/$3/$1\");\n    },\n    downloadIt(id, namefile, cost) {\n      var idUser = this.check_cookie_value(\"id\");\n      var idGoogle = this.check_cookie_value(\"Token\");\n      this.formData = new FormData();\n\n      axios\n        .get(\"http://localhost:8085/api/utenti/\" + idGoogle)\n        .then((response) => {\n          if (response.data.credits > cost) {\n            this.formData.append(\"credits\", response.data.credits - cost);\n            axios\n              .get(\"http://localhost:8085/api/documents/\" + id, {\n                responseType: \"blob\",\n              })\n              .then((response) => {\n                const url = window.URL.createObjectURL(\n                  new Blob([response.data])\n                );\n                console.log(response);\n                console.log(response.headers[\"content-type\"]);\n                const link = document.createElement(\"a\");\n                link.href = url;\n                link.setAttribute(\"download\", namefile);\n                document.body.appendChild(link);\n                link.click();\n                axios\n                  .put(\n                    \"http://localhost:8085/api/utenti/\" +\n                      idUser +\n                      \"/updatecredit\",\n                    this.formData\n                  )\n                  .then((response) => {\n                    console.log(response.data.credits);\n                  });\n              });\n          }\n        });\n    },\n    searchDocuments() {\n      axios\n        .get(\n          \"http://localhost:8085/api/documents/search/\" +\n            this.searchUni +\n            \"/\" +\n            this.searchCourse +\n            \"/\" +\n            this.searchType +\n            \"/\" +\n            this.searchYear\n        )\n        .then((response) => {\n          this.documents = response.data;\n        });\n    },\n  },\n  data() {\n    return {\n      searchUni: null,\n      searchCourse: null,\n      searchType: null,\n      searchYear: null,\n      documents: [],\n    };\n  },\n  mounted() {\n    axios.get(\"http://localhost:8085/api/documents/\").then((response) => {\n      this.documents = response.data;\n    });\n  },\n};\n</script>\n<style scoped>\n.document {\n  height: 30vh;\n  width: 70vw;\n  margin-left: auto;\n  margin-right: auto;\n}\n.card-actions2 {\n  position: absolute;\n  bottom: 0;\n}\n.card-actions {\n  position: absolute;\n  bottom: 0;\n  right: 0;\n}\n.center {\n  margin-left: auto;\n  margin-right: auto;\n}\n</style>\n"]}]}