{"remainingRequest":"/home/ludov/Desktop/duckydoc/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ludov/Desktop/duckydoc/frontend/src/views/Documents.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/ludov/Desktop/duckydoc/frontend/src/views/Documents.vue","mtime":1617049902360},{"path":"/home/ludov/Desktop/duckydoc/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ludov/Desktop/duckydoc/frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/ludov/Desktop/duckydoc/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ludov/Desktop/duckydoc/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiRG9jdW1lbnRzIiwKICBjb21wb25lbnRzOiB7fSwKICB3YXRjaDogewogICAgc2VhcmNoVW5pOiBmdW5jdGlvbiAoKSB7CiAgICAgIGF4aW9zCiAgICAgICAgLmdldCgKICAgICAgICAgICJodHRwOi8vbG9jYWxob3N0OjgwODUvYXBpL2RvY3VtZW50cy9zZWFyY2gvIiArCiAgICAgICAgICAgIHRoaXMuc2VhcmNoVW5pICsKICAgICAgICAgICAgIi8iICsKICAgICAgICAgICAgdGhpcy5zZWFyY2hDb3Vyc2UgKwogICAgICAgICAgICAiLyIgKwogICAgICAgICAgICB0aGlzLnNlYXJjaFR5cGUgKwogICAgICAgICAgICAiLyIgKwogICAgICAgICAgICB0aGlzLnNlYXJjaFllYXIKICAgICAgICApCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICB0aGlzLmRvY3VtZW50cyA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgfSk7CiAgICB9LAogICAgc2VhcmNoQ291cnNlOiBmdW5jdGlvbiAoKSB7CiAgICAgIGF4aW9zCiAgICAgICAgLmdldCgKICAgICAgICAgICJodHRwOi8vbG9jYWxob3N0OjgwODUvYXBpL2RvY3VtZW50cy9zZWFyY2gvIiArCiAgICAgICAgICAgIHRoaXMuc2VhcmNoVW5pICsKICAgICAgICAgICAgIi8iICsKICAgICAgICAgICAgdGhpcy5zZWFyY2hDb3Vyc2UgKwogICAgICAgICAgICAiLyIgKwogICAgICAgICAgICB0aGlzLnNlYXJjaFR5cGUgKwogICAgICAgICAgICAiLyIgKwogICAgICAgICAgICB0aGlzLnNlYXJjaFllYXIKICAgICAgICApCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICB0aGlzLmRvY3VtZW50cyA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgfSk7CiAgICB9LAogICAgc2VhcmNoVHlwZTogZnVuY3Rpb24gKCkgewogICAgICBheGlvcwogICAgICAgIC5nZXQoCiAgICAgICAgICAiaHR0cDovL2xvY2FsaG9zdDo4MDg1L2FwaS9kb2N1bWVudHMvc2VhcmNoLyIgKwogICAgICAgICAgICB0aGlzLnNlYXJjaFVuaSArCiAgICAgICAgICAgICIvIiArCiAgICAgICAgICAgIHRoaXMuc2VhcmNoQ291cnNlICsKICAgICAgICAgICAgIi8iICsKICAgICAgICAgICAgdGhpcy5zZWFyY2hUeXBlICsKICAgICAgICAgICAgIi8iICsKICAgICAgICAgICAgdGhpcy5zZWFyY2hZZWFyCiAgICAgICAgKQogICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgdGhpcy5kb2N1bWVudHMgPSByZXNwb25zZS5kYXRhOwogICAgICAgIH0pOwogICAgfSwKICAgIHNlYXJjaFllYXI6IGZ1bmN0aW9uICgpIHsKICAgICAgYXhpb3MKICAgICAgICAuZ2V0KAogICAgICAgICAgImh0dHA6Ly9sb2NhbGhvc3Q6ODA4NS9hcGkvZG9jdW1lbnRzL3NlYXJjaC8iICsKICAgICAgICAgICAgdGhpcy5zZWFyY2hVbmkgKwogICAgICAgICAgICAiLyIgKwogICAgICAgICAgICB0aGlzLnNlYXJjaENvdXJzZSArCiAgICAgICAgICAgICIvIiArCiAgICAgICAgICAgIHRoaXMuc2VhcmNoVHlwZSArCiAgICAgICAgICAgICIvIiArCiAgICAgICAgICAgIHRoaXMuc2VhcmNoWWVhcgogICAgICAgICkKICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgIHRoaXMuZG9jdW1lbnRzID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICB9KTsKICAgIH0sCiAgfSwKICBtZXRob2RzOiB7CiAgICBjaGVja19jb29raWVfdmFsdWUobmFtZSkgewogICAgICB2YXIgbWF0Y2ggPSBkb2N1bWVudC5jb29raWUubWF0Y2goCiAgICAgICAgbmV3IFJlZ0V4cCgiKF58ICkiICsgbmFtZSArICI9KFteO10rKSIpCiAgICAgICk7CiAgICAgIGlmIChtYXRjaCkgewogICAgICAgIHJldHVybiBtYXRjaFsyXTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gLTE7CiAgICAgIH0KICAgIH0sCiAgICBjb252ZXJ0RGF0ZShkYXRlU3RyaW5nKSB7CiAgICAgIGRhdGVTdHJpbmcgPSBkYXRlU3RyaW5nLnRvU3RyaW5nKCk7CiAgICAgIHJldHVybiBkYXRlU3RyaW5nLnJlcGxhY2UoLyhcZHs0fSkoXGRcZCkoXGRcZCkvZywgIiQyLyQzLyQxIik7CiAgICB9LAogICAgZG93bmxvYWRJdChpZCwgbmFtZWZpbGUsIGNvc3QpIHsKICAgICAgdmFyIGlkVXNlciA9IHRoaXMuY2hlY2tfY29va2llX3ZhbHVlKCJpZCIpOwogICAgICB2YXIgaWRHb29nbGUgPSB0aGlzLmNoZWNrX2Nvb2tpZV92YWx1ZSgiVG9rZW4iKTsKICAgICAgdGhpcy5mb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpOwoKICAgICAgYXhpb3MKICAgICAgICAuZ2V0KCJodHRwOi8vbG9jYWxob3N0OjgwODUvYXBpL3V0ZW50aS8iICsgaWRHb29nbGUpCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5jcmVkaXRzID4gY29zdCkgewogICAgICAgICAgICB0aGlzLmZvcm1EYXRhLmFwcGVuZCgiY3JlZGl0cyIsIHJlc3BvbnNlLmRhdGEuY3JlZGl0cyAtIGNvc3QpOwogICAgICAgICAgICBheGlvcwogICAgICAgICAgICAgIC5nZXQoImh0dHA6Ly9sb2NhbGhvc3Q6ODA4NS9hcGkvZG9jdW1lbnRzL2Rvd25sb2FkLyIgKyBpZCwgewogICAgICAgICAgICAgICAgcmVzcG9uc2VUeXBlOiAiYmxvYiIsCiAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IHVybCA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKAogICAgICAgICAgICAgICAgICBuZXcgQmxvYihbcmVzcG9uc2UuZGF0YV0pCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgICAgICBjb25zdCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpOwogICAgICAgICAgICAgICAgbGluay5ocmVmID0gdXJsOwogICAgICAgICAgICAgICAgbGluay5zZXRBdHRyaWJ1dGUoImRvd25sb2FkIiwgbmFtZWZpbGUpOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChsaW5rKTsKICAgICAgICAgICAgICAgIGxpbmsuY2xpY2soKTsKICAgICAgICAgICAgICAgIGF4aW9zCiAgICAgICAgICAgICAgICAgIC5wdXQoCiAgICAgICAgICAgICAgICAgICAgImh0dHA6Ly9sb2NhbGhvc3Q6ODA4NS9hcGkvdXRlbnRpLyIgKwogICAgICAgICAgICAgICAgICAgICAgaWRVc2VyICsKICAgICAgICAgICAgICAgICAgICAgICIvdXBkYXRlY3JlZGl0IiwKICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm1EYXRhCiAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UuZGF0YS5jcmVkaXRzKTsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLmRpYWxvZyA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9LAogICAgc2VhcmNoRG9jdW1lbnRzKCkgewogICAgICBheGlvcwogICAgICAgIC5nZXQoCiAgICAgICAgICAiaHR0cDovL2xvY2FsaG9zdDo4MDg1L2FwaS9kb2N1bWVudHMvc2VhcmNoLyIgKwogICAgICAgICAgICB0aGlzLnNlYXJjaFVuaSArCiAgICAgICAgICAgICIvIiArCiAgICAgICAgICAgIHRoaXMuc2VhcmNoQ291cnNlICsKICAgICAgICAgICAgIi8iICsKICAgICAgICAgICAgdGhpcy5zZWFyY2hUeXBlICsKICAgICAgICAgICAgIi8iICsKICAgICAgICAgICAgdGhpcy5zZWFyY2hZZWFyCiAgICAgICAgKQogICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgdGhpcy5kb2N1bWVudHMgPSByZXNwb25zZS5kYXRhOwogICAgICAgIH0pOwogICAgfSwKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBkaWFsb2c6IGZhbHNlLAogICAgICBzZWFyY2hVbmk6IG51bGwsCiAgICAgIHNlYXJjaENvdXJzZTogbnVsbCwKICAgICAgc2VhcmNoVHlwZTogbnVsbCwKICAgICAgc2VhcmNoWWVhcjogbnVsbCwKICAgICAgZG9jdW1lbnRzOiBbXSwKICAgIH07CiAgfSwKICBtb3VudGVkKCkgewogICAgYXhpb3MuZ2V0KCJodHRwOi8vbG9jYWxob3N0OjgwODUvYXBpL2RvY3VtZW50cy8iKS50aGVuKChyZXNwb25zZSkgPT4gewogICAgICB0aGlzLmRvY3VtZW50cyA9IHJlc3BvbnNlLmRhdGE7CiAgICB9KTsKICB9LAp9Owo="},{"version":3,"sources":["Documents.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Documents.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <v-dialog v-model=\"dialog\" max-width=\"290\">\n      <v-card class=\"text-center\">\n        <v-card-title class=\"headline\"> Oh no! </v-card-title>\n\n        <v-card-text>\n          It looks like you spent all your coins. Please answer some question or\n          upload some document before continue downloading.\n        </v-card-text>\n\n        <v-card-actions>\n          <v-spacer></v-spacer>\n\n          <v-btn color=\"green darken-1\" text @click=\"dialog = false\">\n            Ok\n          </v-btn>\n        </v-card-actions>\n      </v-card>\n    </v-dialog>\n\n    <v-row>\n      <v-col cols=\"3\">\n        <v-navigation-drawer\n          permanent\n          class=\"full_heigth\"\n          style=\"height: 100%; width: 100%\"\n          dark\n        >\n          <v-list dense>\n            <v-list-item>\n              <v-list-item-content>\n                <v-list-item-title>University</v-list-item-title>\n                <v-text-field\n                  v-model=\"searchUni\"\n                  placeholder=\"insert some keywords\"\n                  solo\n                  class=\"mt-2\"\n                ></v-text-field>\n              </v-list-item-content>\n            </v-list-item>\n\n            <v-list-item>\n              <v-list-item-content>\n                <v-list-item-title>Course</v-list-item-title>\n                <v-text-field\n                  v-model=\"searchCourse\"\n                  placeholder=\"insert some keywords\"\n                  solo\n                  class=\"mt-2\"\n                ></v-text-field>\n              </v-list-item-content>\n            </v-list-item>\n\n            <v-list-item>\n              <v-list-item-content>\n                <v-list-item-title>Typology</v-list-item-title>\n                <v-text-field\n                  v-model=\"searchType\"\n                  placeholder=\"insert some keywords\"\n                  solo\n                  class=\"mt-2\"\n                ></v-text-field>\n              </v-list-item-content>\n            </v-list-item>\n            <v-list-item>\n              <v-list-item-content>\n                <v-list-item-title>Year</v-list-item-title>\n                <v-text-field\n                  v-model=\"searchYear\"\n                  placeholder=\"insert some keywords\"\n                  solo\n                  class=\"mt-2\"\n                ></v-text-field>\n              </v-list-item-content>\n            </v-list-item>\n            <v-list-item>\n              <v-btn @click=\"searchDocuments()\" class=\"center\"> Search </v-btn>\n            </v-list-item>\n          </v-list>\n        </v-navigation-drawer>\n      </v-col>\n      <v-col cols=\"9\">\n        <v-card\n          v-for=\"(document, index) in documents\"\n          :key=\"index\"\n          color=\"#1548e094\"\n          class=\"mt-2 document\"\n        >\n          <v-card-title class=\"headline\"> {{ document.title }}</v-card-title>\n\n          <v-card-text>{{ document.user.username }}</v-card-text>\n\n          <v-card-actions class=\"card-actions\">\n            <v-btn\n              @click=\"\n                downloadIt(document.id, document.nameFile, document.price)\n              \"\n            >\n              Download\n            </v-btn>\n          </v-card-actions>\n          <v-card-actions class=\"card-actions2\">\n            <v-btn text disabled>\n              {{ convertDate(document.creationData) }}\n            </v-btn>\n          </v-card-actions>\n        </v-card>\n      </v-col>\n    </v-row>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nexport default {\n  name: \"Documents\",\n  components: {},\n  watch: {\n    searchUni: function () {\n      axios\n        .get(\n          \"http://localhost:8085/api/documents/search/\" +\n            this.searchUni +\n            \"/\" +\n            this.searchCourse +\n            \"/\" +\n            this.searchType +\n            \"/\" +\n            this.searchYear\n        )\n        .then((response) => {\n          this.documents = response.data;\n        });\n    },\n    searchCourse: function () {\n      axios\n        .get(\n          \"http://localhost:8085/api/documents/search/\" +\n            this.searchUni +\n            \"/\" +\n            this.searchCourse +\n            \"/\" +\n            this.searchType +\n            \"/\" +\n            this.searchYear\n        )\n        .then((response) => {\n          this.documents = response.data;\n        });\n    },\n    searchType: function () {\n      axios\n        .get(\n          \"http://localhost:8085/api/documents/search/\" +\n            this.searchUni +\n            \"/\" +\n            this.searchCourse +\n            \"/\" +\n            this.searchType +\n            \"/\" +\n            this.searchYear\n        )\n        .then((response) => {\n          this.documents = response.data;\n        });\n    },\n    searchYear: function () {\n      axios\n        .get(\n          \"http://localhost:8085/api/documents/search/\" +\n            this.searchUni +\n            \"/\" +\n            this.searchCourse +\n            \"/\" +\n            this.searchType +\n            \"/\" +\n            this.searchYear\n        )\n        .then((response) => {\n          this.documents = response.data;\n        });\n    },\n  },\n  methods: {\n    check_cookie_value(name) {\n      var match = document.cookie.match(\n        new RegExp(\"(^| )\" + name + \"=([^;]+)\")\n      );\n      if (match) {\n        return match[2];\n      } else {\n        return -1;\n      }\n    },\n    convertDate(dateString) {\n      dateString = dateString.toString();\n      return dateString.replace(/(\\d{4})(\\d\\d)(\\d\\d)/g, \"$2/$3/$1\");\n    },\n    downloadIt(id, namefile, cost) {\n      var idUser = this.check_cookie_value(\"id\");\n      var idGoogle = this.check_cookie_value(\"Token\");\n      this.formData = new FormData();\n\n      axios\n        .get(\"http://localhost:8085/api/utenti/\" + idGoogle)\n        .then((response) => {\n          if (response.data.credits > cost) {\n            this.formData.append(\"credits\", response.data.credits - cost);\n            axios\n              .get(\"http://localhost:8085/api/documents/download/\" + id, {\n                responseType: \"blob\",\n              })\n              .then((response) => {\n                const url = window.URL.createObjectURL(\n                  new Blob([response.data])\n                );\n                console.log(response.data);\n                const link = document.createElement(\"a\");\n                link.href = url;\n                link.setAttribute(\"download\", namefile);\n                document.body.appendChild(link);\n                link.click();\n                axios\n                  .put(\n                    \"http://localhost:8085/api/utenti/\" +\n                      idUser +\n                      \"/updatecredit\",\n                    this.formData\n                  )\n                  .then((response) => {\n                    console.log(response.data.credits);\n                  });\n              });\n          } else {\n            this.dialog = true;\n          }\n        });\n    },\n    searchDocuments() {\n      axios\n        .get(\n          \"http://localhost:8085/api/documents/search/\" +\n            this.searchUni +\n            \"/\" +\n            this.searchCourse +\n            \"/\" +\n            this.searchType +\n            \"/\" +\n            this.searchYear\n        )\n        .then((response) => {\n          this.documents = response.data;\n        });\n    },\n  },\n  data() {\n    return {\n      dialog: false,\n      searchUni: null,\n      searchCourse: null,\n      searchType: null,\n      searchYear: null,\n      documents: [],\n    };\n  },\n  mounted() {\n    axios.get(\"http://localhost:8085/api/documents/\").then((response) => {\n      this.documents = response.data;\n    });\n  },\n};\n</script>\n<style scoped>\n.document {\n  height: 30vh;\n  width: 70vw;\n  margin-left: auto;\n  margin-right: auto;\n}\n.card-actions2 {\n  position: absolute;\n  bottom: 0;\n}\n.card-actions {\n  position: absolute;\n  bottom: 0;\n  right: 0;\n}\n.center {\n  margin-left: auto;\n  margin-right: auto;\n}\n</style>\n"]}]}