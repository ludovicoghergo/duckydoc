{"remainingRequest":"/home/ludov/Desktop/duckydoc/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ludov/Desktop/duckydoc/frontend/src/views/Documents.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/ludov/Desktop/duckydoc/frontend/src/views/Documents.vue","mtime":1617055459552},{"path":"/home/ludov/Desktop/duckydoc/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ludov/Desktop/duckydoc/frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/ludov/Desktop/duckydoc/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ludov/Desktop/duckydoc/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiRG9jdW1lbnRzIiwKICBjb21wb25lbnRzOiB7fSwKICB3YXRjaDogewogICAgc2VhcmNoVW5pOiBmdW5jdGlvbiAodmFsKSB7CiAgICAgIGlmICh2YWwgPT0gIiIpIHRoaXMuc2VhcmNoVW5pID0gbnVsbDsKICAgICAgYXhpb3MKICAgICAgICAuZ2V0KAogICAgICAgICAgImh0dHA6Ly9sb2NhbGhvc3Q6ODA4NS9hcGkvZG9jdW1lbnRzL3NlYXJjaC8iICsKICAgICAgICAgICAgdGhpcy5zZWFyY2hVbmkgKwogICAgICAgICAgICAiLyIgKwogICAgICAgICAgICB0aGlzLnNlYXJjaENvdXJzZSArCiAgICAgICAgICAgICIvIiArCiAgICAgICAgICAgIHRoaXMuc2VhcmNoVHlwZSArCiAgICAgICAgICAgICIvIiArCiAgICAgICAgICAgIHRoaXMuc2VhcmNoWWVhcgogICAgICAgICkKICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgIHRoaXMuZG9jdW1lbnRzID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICB9KTsKICAgIH0sCiAgICBzZWFyY2hDb3Vyc2U6IGZ1bmN0aW9uICh2YWwpIHsKICAgICAgaWYgKHZhbCA9PSAiIikgdGhpcy5zZWFyY2hDb3Vyc2UgPSBudWxsOwogICAgICBheGlvcwogICAgICAgIC5nZXQoCiAgICAgICAgICAiaHR0cDovL2xvY2FsaG9zdDo4MDg1L2FwaS9kb2N1bWVudHMvc2VhcmNoLyIgKwogICAgICAgICAgICB0aGlzLnNlYXJjaFVuaSArCiAgICAgICAgICAgICIvIiArCiAgICAgICAgICAgIHRoaXMuc2VhcmNoQ291cnNlICsKICAgICAgICAgICAgIi8iICsKICAgICAgICAgICAgdGhpcy5zZWFyY2hUeXBlICsKICAgICAgICAgICAgIi8iICsKICAgICAgICAgICAgdGhpcy5zZWFyY2hZZWFyCiAgICAgICAgKQogICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgdGhpcy5kb2N1bWVudHMgPSByZXNwb25zZS5kYXRhOwogICAgICAgIH0pOwogICAgfSwKICAgIHNlYXJjaFR5cGU6IGZ1bmN0aW9uICh2YWwpIHsKICAgICAgaWYgKHZhbCA9PSAiIikgdGhpcy5zZWFyY2hUeXBlID0gbnVsbDsKICAgICAgYXhpb3MKICAgICAgICAuZ2V0KAogICAgICAgICAgImh0dHA6Ly9sb2NhbGhvc3Q6ODA4NS9hcGkvZG9jdW1lbnRzL3NlYXJjaC8iICsKICAgICAgICAgICAgdGhpcy5zZWFyY2hVbmkgKwogICAgICAgICAgICAiLyIgKwogICAgICAgICAgICB0aGlzLnNlYXJjaENvdXJzZSArCiAgICAgICAgICAgICIvIiArCiAgICAgICAgICAgIHRoaXMuc2VhcmNoVHlwZSArCiAgICAgICAgICAgICIvIiArCiAgICAgICAgICAgIHRoaXMuc2VhcmNoWWVhcgogICAgICAgICkKICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgIHRoaXMuZG9jdW1lbnRzID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICB9KTsKICAgIH0sCiAgICBzZWFyY2hZZWFyOiBmdW5jdGlvbiAodmFsKSB7CiAgICAgIGlmICh2YWwgPT0gIiIpIHRoaXMuc2VhcmNoWWVhciA9IG51bGw7CiAgICAgIGF4aW9zCiAgICAgICAgLmdldCgKICAgICAgICAgICJodHRwOi8vbG9jYWxob3N0OjgwODUvYXBpL2RvY3VtZW50cy9zZWFyY2gvIiArCiAgICAgICAgICAgIHRoaXMuc2VhcmNoVW5pICsKICAgICAgICAgICAgIi8iICsKICAgICAgICAgICAgdGhpcy5zZWFyY2hDb3Vyc2UgKwogICAgICAgICAgICAiLyIgKwogICAgICAgICAgICB0aGlzLnNlYXJjaFR5cGUgKwogICAgICAgICAgICAiLyIgKwogICAgICAgICAgICB0aGlzLnNlYXJjaFllYXIKICAgICAgICApCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICB0aGlzLmRvY3VtZW50cyA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgfSk7CiAgICB9LAogIH0sCiAgbWV0aG9kczogewogICAgY2hlY2tfY29va2llX3ZhbHVlKG5hbWUpIHsKICAgICAgdmFyIG1hdGNoID0gZG9jdW1lbnQuY29va2llLm1hdGNoKAogICAgICAgIG5ldyBSZWdFeHAoIihefCApIiArIG5hbWUgKyAiPShbXjtdKykiKQogICAgICApOwogICAgICBpZiAobWF0Y2gpIHsKICAgICAgICByZXR1cm4gbWF0Y2hbMl07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIC0xOwogICAgICB9CiAgICB9LAogICAgY29udmVydERhdGUoZGF0ZVN0cmluZykgewogICAgICBkYXRlU3RyaW5nID0gZGF0ZVN0cmluZy50b1N0cmluZygpOwogICAgICByZXR1cm4gZGF0ZVN0cmluZy5yZXBsYWNlKC8oXGR7NH0pKFxkXGQpKFxkXGQpL2csICIkMi8kMy8kMSIpOwogICAgfSwKICAgIGRvd25sb2FkSXQoaWQsIG5hbWVmaWxlLCBjb3N0KSB7CiAgICAgIHZhciBpZFVzZXIgPSB0aGlzLmNoZWNrX2Nvb2tpZV92YWx1ZSgiaWQiKTsKICAgICAgdmFyIGlkR29vZ2xlID0gdGhpcy5jaGVja19jb29raWVfdmFsdWUoIlRva2VuIik7CiAgICAgIHRoaXMuZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTsKCiAgICAgIGF4aW9zCiAgICAgICAgLmdldCgiaHR0cDovL2xvY2FsaG9zdDo4MDg1L2FwaS91dGVudGkvIiArIGlkR29vZ2xlKQogICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuY3JlZGl0cyA+IGNvc3QpIHsKICAgICAgICAgICAgdGhpcy5mb3JtRGF0YS5hcHBlbmQoImNyZWRpdHMiLCByZXNwb25zZS5kYXRhLmNyZWRpdHMgLSBjb3N0KTsKICAgICAgICAgICAgYXhpb3MKICAgICAgICAgICAgICAuZ2V0KCJodHRwOi8vbG9jYWxob3N0OjgwODUvYXBpL2RvY3VtZW50cy9kb3dubG9hZC8iICsgaWQsIHsKICAgICAgICAgICAgICAgIHJlc3BvbnNlVHlwZTogImJsb2IiLAogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCB1cmwgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTCgKICAgICAgICAgICAgICAgICAgbmV3IEJsb2IoW3Jlc3BvbnNlLmRhdGFdKQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKTsKICAgICAgICAgICAgICAgIGxpbmsuaHJlZiA9IHVybDsKICAgICAgICAgICAgICAgIGxpbmsuc2V0QXR0cmlidXRlKCJkb3dubG9hZCIsIG5hbWVmaWxlKTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobGluayk7CiAgICAgICAgICAgICAgICBsaW5rLmNsaWNrKCk7CiAgICAgICAgICAgICAgICBheGlvcwogICAgICAgICAgICAgICAgICAucHV0KAogICAgICAgICAgICAgICAgICAgICJodHRwOi8vbG9jYWxob3N0OjgwODUvYXBpL3V0ZW50aS8iICsKICAgICAgICAgICAgICAgICAgICAgIGlkVXNlciArCiAgICAgICAgICAgICAgICAgICAgICAiL3VwZGF0ZWNyZWRpdCIsCiAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtRGF0YQogICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlLmRhdGEuY3JlZGl0cyk7CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5kaWFsb2cgPSB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKICAgIHNlYXJjaERvY3VtZW50cygpIHsKICAgICAgYXhpb3MKICAgICAgICAuZ2V0KAogICAgICAgICAgImh0dHA6Ly9sb2NhbGhvc3Q6ODA4NS9hcGkvZG9jdW1lbnRzL3NlYXJjaC8iICsKICAgICAgICAgICAgdGhpcy5zZWFyY2hVbmkgKwogICAgICAgICAgICAiLyIgKwogICAgICAgICAgICB0aGlzLnNlYXJjaENvdXJzZSArCiAgICAgICAgICAgICIvIiArCiAgICAgICAgICAgIHRoaXMuc2VhcmNoVHlwZSArCiAgICAgICAgICAgICIvIiArCiAgICAgICAgICAgIHRoaXMuc2VhcmNoWWVhcgogICAgICAgICkKICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgIHRoaXMuZG9jdW1lbnRzID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICB9KTsKICAgIH0sCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZGlhbG9nOiBmYWxzZSwKICAgICAgc2VhcmNoVW5pOiBudWxsLAogICAgICBzZWFyY2hDb3Vyc2U6IG51bGwsCiAgICAgIHNlYXJjaFR5cGU6IG51bGwsCiAgICAgIHNlYXJjaFllYXI6IG51bGwsCiAgICAgIGRvY3VtZW50czogW10sCiAgICB9OwogIH0sCiAgbW91bnRlZCgpIHsKICAgIGF4aW9zLmdldCgiaHR0cDovL2xvY2FsaG9zdDo4MDg1L2FwaS9kb2N1bWVudHMvIikudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgdGhpcy5kb2N1bWVudHMgPSByZXNwb25zZS5kYXRhOwogICAgfSk7CiAgfSwKfTsK"},{"version":3,"sources":["Documents.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Documents.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <v-dialog v-model=\"dialog\" max-width=\"290\">\n      <v-card class=\"text-center\">\n        <v-card-title class=\"headline\"> Oh no! </v-card-title>\n\n        <v-card-text>\n          It looks like you spent all your coins. Please answer some question or\n          upload some document before continue downloading.\n        </v-card-text>\n\n        <v-card-actions>\n          <v-spacer></v-spacer>\n\n          <v-btn color=\"green darken-1\" text @click=\"dialog = false\">\n            Ok\n          </v-btn>\n        </v-card-actions>\n      </v-card>\n    </v-dialog>\n\n    <v-row>\n      <v-col cols=\"3\">\n        <v-navigation-drawer\n          permanent\n          class=\"full_heigth\"\n          style=\"height: 100%; width: 100%\"\n          dark\n        >\n          <v-list dense>\n            <v-list-item>\n              <v-list-item-content>\n                <v-list-item-title>University</v-list-item-title>\n                <v-text-field\n                  v-model=\"searchUni\"\n                  placeholder=\"insert some keywords\"\n                  solo\n                  class=\"mt-2\"\n                ></v-text-field>\n              </v-list-item-content>\n            </v-list-item>\n\n            <v-list-item>\n              <v-list-item-content>\n                <v-list-item-title>Course</v-list-item-title>\n                <v-text-field\n                  v-model=\"searchCourse\"\n                  placeholder=\"insert some keywords\"\n                  solo\n                  class=\"mt-2\"\n                ></v-text-field>\n              </v-list-item-content>\n            </v-list-item>\n\n            <v-list-item>\n              <v-list-item-content>\n                <v-list-item-title>Typology</v-list-item-title>\n                <v-text-field\n                  v-model=\"searchType\"\n                  placeholder=\"insert some keywords\"\n                  solo\n                  class=\"mt-2\"\n                ></v-text-field>\n              </v-list-item-content>\n            </v-list-item>\n            <v-list-item>\n              <v-list-item-content>\n                <v-list-item-title>Year</v-list-item-title>\n                <v-text-field\n                  v-model=\"searchYear\"\n                  placeholder=\"insert some keywords\"\n                  solo\n                  class=\"mt-2\"\n                ></v-text-field>\n              </v-list-item-content>\n            </v-list-item>\n          </v-list>\n        </v-navigation-drawer>\n      </v-col>\n      <v-col cols=\"9\">\n        <v-card\n          v-for=\"(document, index) in documents\"\n          :key=\"index\"\n          color=\"#1548e094\"\n          class=\"mt-2 document\"\n        >\n          <v-card-title class=\"headline\"> {{ document.title }}</v-card-title>\n\n          <v-card-text>{{ document.user.username }}</v-card-text>\n\n          <v-card-actions class=\"card-actions\">\n            <v-btn\n              @click=\"\n                downloadIt(document.id, document.nameFile, document.price)\n              \"\n            >\n              Download\n            </v-btn>\n          </v-card-actions>\n          <v-card-actions class=\"card-actions2\">\n            <v-btn text disabled>\n              {{ convertDate(document.creationData) }}\n            </v-btn>\n          </v-card-actions>\n        </v-card>\n      </v-col>\n    </v-row>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nexport default {\n  name: \"Documents\",\n  components: {},\n  watch: {\n    searchUni: function (val) {\n      if (val == \"\") this.searchUni = null;\n      axios\n        .get(\n          \"http://localhost:8085/api/documents/search/\" +\n            this.searchUni +\n            \"/\" +\n            this.searchCourse +\n            \"/\" +\n            this.searchType +\n            \"/\" +\n            this.searchYear\n        )\n        .then((response) => {\n          this.documents = response.data;\n        });\n    },\n    searchCourse: function (val) {\n      if (val == \"\") this.searchCourse = null;\n      axios\n        .get(\n          \"http://localhost:8085/api/documents/search/\" +\n            this.searchUni +\n            \"/\" +\n            this.searchCourse +\n            \"/\" +\n            this.searchType +\n            \"/\" +\n            this.searchYear\n        )\n        .then((response) => {\n          this.documents = response.data;\n        });\n    },\n    searchType: function (val) {\n      if (val == \"\") this.searchType = null;\n      axios\n        .get(\n          \"http://localhost:8085/api/documents/search/\" +\n            this.searchUni +\n            \"/\" +\n            this.searchCourse +\n            \"/\" +\n            this.searchType +\n            \"/\" +\n            this.searchYear\n        )\n        .then((response) => {\n          this.documents = response.data;\n        });\n    },\n    searchYear: function (val) {\n      if (val == \"\") this.searchYear = null;\n      axios\n        .get(\n          \"http://localhost:8085/api/documents/search/\" +\n            this.searchUni +\n            \"/\" +\n            this.searchCourse +\n            \"/\" +\n            this.searchType +\n            \"/\" +\n            this.searchYear\n        )\n        .then((response) => {\n          this.documents = response.data;\n        });\n    },\n  },\n  methods: {\n    check_cookie_value(name) {\n      var match = document.cookie.match(\n        new RegExp(\"(^| )\" + name + \"=([^;]+)\")\n      );\n      if (match) {\n        return match[2];\n      } else {\n        return -1;\n      }\n    },\n    convertDate(dateString) {\n      dateString = dateString.toString();\n      return dateString.replace(/(\\d{4})(\\d\\d)(\\d\\d)/g, \"$2/$3/$1\");\n    },\n    downloadIt(id, namefile, cost) {\n      var idUser = this.check_cookie_value(\"id\");\n      var idGoogle = this.check_cookie_value(\"Token\");\n      this.formData = new FormData();\n\n      axios\n        .get(\"http://localhost:8085/api/utenti/\" + idGoogle)\n        .then((response) => {\n          if (response.data.credits > cost) {\n            this.formData.append(\"credits\", response.data.credits - cost);\n            axios\n              .get(\"http://localhost:8085/api/documents/download/\" + id, {\n                responseType: \"blob\",\n              })\n              .then((response) => {\n                const url = window.URL.createObjectURL(\n                  new Blob([response.data])\n                );\n                console.log(response.data);\n                const link = document.createElement(\"a\");\n                link.href = url;\n                link.setAttribute(\"download\", namefile);\n                document.body.appendChild(link);\n                link.click();\n                axios\n                  .put(\n                    \"http://localhost:8085/api/utenti/\" +\n                      idUser +\n                      \"/updatecredit\",\n                    this.formData\n                  )\n                  .then((response) => {\n                    console.log(response.data.credits);\n                  });\n              });\n          } else {\n            this.dialog = true;\n          }\n        });\n    },\n    searchDocuments() {\n      axios\n        .get(\n          \"http://localhost:8085/api/documents/search/\" +\n            this.searchUni +\n            \"/\" +\n            this.searchCourse +\n            \"/\" +\n            this.searchType +\n            \"/\" +\n            this.searchYear\n        )\n        .then((response) => {\n          this.documents = response.data;\n        });\n    },\n  },\n  data() {\n    return {\n      dialog: false,\n      searchUni: null,\n      searchCourse: null,\n      searchType: null,\n      searchYear: null,\n      documents: [],\n    };\n  },\n  mounted() {\n    axios.get(\"http://localhost:8085/api/documents/\").then((response) => {\n      this.documents = response.data;\n    });\n  },\n};\n</script>\n<style scoped>\n.document {\n  height: 30vh;\n  width: 70vw;\n  margin-left: auto;\n  margin-right: auto;\n}\n.card-actions2 {\n  position: absolute;\n  bottom: 0;\n}\n.card-actions {\n  position: absolute;\n  bottom: 0;\n  right: 0;\n}\n.center {\n  margin-left: auto;\n  margin-right: auto;\n}\n</style>\n"]}]}